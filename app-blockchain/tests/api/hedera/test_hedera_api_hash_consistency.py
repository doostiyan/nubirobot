import pytest
from unittest import TestCase
from unittest.mock import Mock
from django.conf import settings

from exchange.blockchain.explorer_original import BlockchainExplorer

if settings.BLOCKCHAIN_CACHE_PREFIX == 'cold_':
    from wallet.models import CURRENCIES as Currencies
else:
    from exchange.base.models import Currencies

from exchange.blockchain.api.hedera.hedera_explorer_interface import HederaExplorerInterface
from exchange.blockchain.api.hedera.hedera_mirrornode import MirrorNodeHederaApi
from exchange.blockchain.api.hedera.hedera_graphql import GraphqlHederaApi


class TestHederaHashConsistency(TestCase):
    currency = 112
    hash_of_transactions = ['0.0.1070126-1662368439-606540089', '0.0.19790-1662452132-466145872']
    address_txs = ['0.0.38674']

    @pytest.mark.django_db
    def test_get_tx_details_hash_consistency(self):
        mirror_node_api = MirrorNodeHederaApi
        mirror_node_tx_details_mock_response = [
            {'transactions': [{'bytes': None, 'charged_tx_fee': 164612, 'consensus_timestamp': '1662368451.490344705',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTg5MzY4OTM2Mw==',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'fosTgVsWy8FquzGBAvpVVOmBTNUlw729bzEIsQj8QvRkccm7J8zyPz47XQCGz69P',
                               'transaction_id': '0.0.1070126-1662368439-606540089',
                               'transfers': [{'account': '0.0.3', 'amount': 6670, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 157942, 'is_approval': False},
                                             {'account': '0.0.407219', 'amount': 7500000000, 'is_approval': False},
                                             {'account': '0.0.1070126', 'amount': -7500164612, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1662368439.606540089'}]},
            {'transactions': [{'bytes': None, 'charged_tx_fee': 259407, 'consensus_timestamp': '1662452142.380920003',
                               'entity_id': None, 'max_fee': '4000000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.4', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'oOVgRVbhkiY7gMfEVgu2186VXjkODxkSsSELA2YrIp4eDR1IR78BulCXe8hiLPgw',
                               'transaction_id': '0.0.19790-1662452132-466145872',
                               'transfers': [{'account': '0.0.4', 'amount': 6655, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 252752, 'is_approval': False},
                                             {'account': '0.0.14684', 'amount': 90000, 'is_approval': False},
                                             {'account': '0.0.14698', 'amount': -90000, 'is_approval': False},
                                             {'account': '0.0.19790', 'amount': -259407, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1662452132.466145872'}]}
        ]
        mirror_node_api.request = Mock(side_effect=mirror_node_tx_details_mock_response)
        HederaExplorerInterface.tx_details_apis[0] = mirror_node_api
        mirror_node_txs_details = BlockchainExplorer.get_transactions_details(self.hash_of_transactions, 'HBAR')
        graphql_api = GraphqlHederaApi
        graphql_tx_details_mock_response = [
            {'transactions': [{'bytes': None, 'charged_tx_fee': 164612, 'consensus_timestamp': '1662368451.490344705',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTg5MzY4OTM2Mw==',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'fosTgVsWy8FquzGBAvpVVOmBTNUlw729bzEIsQj8QvRkccm7J8zyPz47XQCGz69P',
                               'transaction_id': '0.0.1070126-1662368439-606540089',
                               'transfers': [{'account': '0.0.3', 'amount': 6670, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 157942, 'is_approval': False},
                                             {'account': '0.0.407219', 'amount': 7500000000, 'is_approval': False},
                                             {'account': '0.0.1070126', 'amount': -7500164612, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1662368439.606540089'}]},
            {'transactions': [{'bytes': None, 'charged_tx_fee': 259407, 'consensus_timestamp': '1662452142.380920003',
                               'entity_id': None, 'max_fee': '4000000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.4', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'oOVgRVbhkiY7gMfEVgu2186VXjkODxkSsSELA2YrIp4eDR1IR78BulCXe8hiLPgw',
                               'transaction_id': '0.0.19790-1662452132-466145872',
                               'transfers': [{'account': '0.0.4', 'amount': 6655, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 252752, 'is_approval': False},
                                             {'account': '0.0.14684', 'amount': 90000, 'is_approval': False},
                                             {'account': '0.0.14698', 'amount': -90000, 'is_approval': False},
                                             {'account': '0.0.19790', 'amount': -259407, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1662452132.466145872'}]}
        ]
        graphql_api.request = Mock(side_effect=graphql_tx_details_mock_response)
        HederaExplorerInterface.tx_details_apis[0] = graphql_api
        graphql_txs_details = BlockchainExplorer.get_transactions_details(self.hash_of_transactions, 'HBAR')
        for tx_hash in self.hash_of_transactions:
            assert mirror_node_txs_details.get(tx_hash).get('hash') == graphql_txs_details.get(tx_hash).get('hash')

    def test_get_txs_hash_consistency(self):
        mirror_node_api = MirrorNodeHederaApi
        mirror_node_get_address_txs_mock_response = [
            {'transactions': [{'bytes': None, 'charged_tx_fee': 202379, 'consensus_timestamp': '1696100403.623366012',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.4', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'CHCjU2gg8KmzYWhEfgM6rrbkWLbhbGfCtbUD/zl7dQ4jKCy6qnaIa+/Cy0Mi2u09',
                               'transaction_id': '0.0.38674-1696100389-795053433',
                               'transfers': [{'account': '0.0.4', 'amount': 8197, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174764, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19418, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -33999999999760, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 33999999797381,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1696100389.795053433'},
                              {'bytes': None, 'charged_tx_fee': 202830, 'consensus_timestamp': '1696099768.935000003',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAwNzg4MzA4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'TMrUJl+JEp4xX1ItyzoF3GQpO7s0fGKbYFIESDkJ28ibxiFKbgQfCYd2q2N4O3zd',
                               'transaction_id': '0.0.161517-1696099726-988600225',
                               'transfers': [{'account': '0.0.4', 'amount': 8219, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175150, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19461, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 34000000000000, 'is_approval': False},
                                             {'account': '0.0.161517', 'amount': -34000000202830,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1696099726.988600225'},
                              {'bytes': None, 'charged_tx_fee': 202619, 'consensus_timestamp': '1695988803.316344003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.19', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'Ba2IkHAIkbDkUivjRafuQjZ2YWgozNnXWK4pBjV6Xy67OKA22lZ3Te3DspIcPYtj',
                               'transaction_id': '0.0.38674-1695988792-379185529',
                               'transfers': [{'account': '0.0.19', 'amount': 8207, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174971, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19441, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -1879968372992, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 1879968170373, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695988792.379185529'},
                              {'bytes': None, 'charged_tx_fee': 202908, 'consensus_timestamp': '1695988479.959919003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTAxMDIzOTUwCg==',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.12', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'TIlEZnAsHOMhPIri0WbDaDrZhL3bpOHqTLqW2HPkvLjpZXyjn9wUuwZKqYf9ZwTE',
                               'transaction_id': '0.0.947373-1695988469-492711143',
                               'transfers': [{'account': '0.0.12', 'amount': 8222, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175218, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19468, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 1316600000000, 'is_approval': False},
                                             {'account': '0.0.947373', 'amount': -1316600202908, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695988469.492711143'},
                              {'bytes': None, 'charged_tx_fee': 202857, 'consensus_timestamp': '1695988245.407690602',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTAxMDIzOTUw',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.27', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'VEire6xBonGrz8l70Br5afad4hf1tryLCUotqNYs7QES3yyl631+0ZAfpQ4g/EtV',
                               'transaction_id': '0.0.947373-1695988233-577706803',
                               'transfers': [{'account': '0.0.27', 'amount': 8220, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175174, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19463, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 10000000000, 'is_approval': False},
                                             {'account': '0.0.947373', 'amount': -10000202857, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695988233.577706803'},
                              {'bytes': None, 'charged_tx_fee': 202955, 'consensus_timestamp': '1695958924.241375003',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAyMzk4NzMw',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.16', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'BzkNp4Ro2lbW1iy/Wi0LRIZVjtUiK5RBjafvawjqfyozAX4f5hrvgL7nuXcevU+P',
                               'transaction_id': '0.0.1686716-1695958917-132282711',
                               'transfers': [{'account': '0.0.16', 'amount': 8224, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175258, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19473, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 351739860000, 'is_approval': False},
                                             {'account': '0.0.1686716', 'amount': -351740062955, 'is_approval': False}],
                               'valid_duration_seconds': '180', 'valid_start_timestamp': '1695958917.132282711'},
                              {'bytes': None, 'charged_tx_fee': 202955, 'consensus_timestamp': '1695956852.048122783',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0MzgxMTI1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.7', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'ECsO/ka2jaEmAvcKm6QzbmVcWKGYu1e3DldmU2d7xzYSAu4Kr084619Q21/r11zs',
                               'transaction_id': '0.0.845966-1695956842-737665842',
                               'transfers': [{'account': '0.0.7', 'amount': 8224, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175258, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19473, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 201628513175, 'is_approval': False},
                                             {'account': '0.0.845966', 'amount': -201628716130, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695956842.737665842'},
                              {'bytes': None, 'charged_tx_fee': 202802, 'consensus_timestamp': '1695924003.110434003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.13', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'dQO1BhX/fKPSu4QkvMUqWszz+4kBV6JTndNN/AIfbuhMRr6mPcF5zLafUf4eyZK1',
                               'transaction_id': '0.0.38674-1695923990-206523488',
                               'transfers': [{'account': '0.0.13', 'amount': 8214, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175130, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19458, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -5099999999236, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 5099999796434, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695923990.206523488'},
                              {'bytes': None, 'charged_tx_fee': 202874, 'consensus_timestamp': '1695923755.903899003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0MDgxMjU1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.22', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'tuAw03Cznwqbb2jrOS+mmXi1+V1Yf5YDOEDVXprOOaO5Ln5PLGzb12i1jDUkMYln',
                               'transaction_id': '0.0.1050547-1695923743-443744917',
                               'transfers': [{'account': '0.0.22', 'amount': 8221, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19465, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 5000000000000, 'is_approval': False},
                                             {'account': '0.0.1050547', 'amount': -5000000202874,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695923743.443744917'},
                              {'bytes': None, 'charged_tx_fee': 202874, 'consensus_timestamp': '1695923615.247364003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0MDgxMjU1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.21', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'NbC28uP3m1qhyOd3QoUbfhk9YndMz7wy/h3sRiWQxhqmYkqBH6HEjDxdPmHhi0dL',
                               'transaction_id': '0.0.1050547-1695923603-689181890',
                               'transfers': [{'account': '0.0.21', 'amount': 8221, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19465, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 100000000000, 'is_approval': False},
                                             {'account': '0.0.1050547', 'amount': -100000202874, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695923603.689181890'},
                              {'bytes': None, 'charged_tx_fee': 203566, 'consensus_timestamp': '1695913202.852538003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.11', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'R/pEDLW8yOF0nbl6Y5MtBORzWtZrrOJTsKcw2u/FJ3S15r1SxMVRiNHJ/cyMnXzk',
                               'transaction_id': '0.0.38674-1695913191-420570521',
                               'transfers': [{'account': '0.0.11', 'amount': 8245, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175789, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19532, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -108134104828388, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 108134104624822,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695913191.420570521'},
                              {'bytes': None, 'charged_tx_fee': 204616, 'consensus_timestamp': '1695912368.599666083',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.8', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '4MEap6PXF0TervxaAjVGMZ1DGBT2cm5Fr4mYEae3Yis4WFKQBvybBCB+Mwl3Lu4H',
                               'transaction_id': '0.0.1454258-1695912357-027099927',
                               'transfers': [{'account': '0.0.8', 'amount': 8291, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176693, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19632, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 108134104828974, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': -108134105033590,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695912357.027099927'},
                              {'bytes': None, 'charged_tx_fee': 204152, 'consensus_timestamp': '1695912302.975616164',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.3', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'mYKrsBV3RiW227Efg1Pyn2m9jtajqFK931Gc5BNnxgC9bwkZNKczX2Hko8SD7Z6m',
                               'transaction_id': '0.0.38674-1695912292-276756881',
                               'transfers': [{'account': '0.0.3', 'amount': 8269, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176295, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19588, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -2361374866881, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 2361374662729, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695912292.276756881'},
                              {'bytes': None, 'charged_tx_fee': 204616, 'consensus_timestamp': '1695911638.775140338',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.8', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'g1rd7iDgY/aHnc4OcFj2IdHs95ETzq9N86eYVCSgkfLT/g0JRIeJUfAdn89efdpJ',
                               'transaction_id': '0.0.1454258-1695911626-396261009',
                               'transfers': [{'account': '0.0.8', 'amount': 8291, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176693, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19632, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 1810205100000, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': -1810205304616,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695911626.396261009'},
                              {'bytes': None, 'charged_tx_fee': 204533, 'consensus_timestamp': '1695767920.360873003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTAyODQzMDA4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.15', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'aJ1gaMrOaCvzr+FmyxoQK36wIxBDXvZxahA/4EkOENG2R8J2fOKfjG97ERb9Vect',
                               'transaction_id': '0.0.1917742-1695767919-217445219',
                               'transfers': [{'account': '0.0.15', 'amount': 8288, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176621, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19624, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 500013429208, 'is_approval': False},
                                             {'account': '0.0.1917742', 'amount': -500013633741, 'is_approval': False}],
                               'valid_duration_seconds': '180', 'valid_start_timestamp': '1695767919.217445219'},
                              {'bytes': None, 'charged_tx_fee': 194450, 'consensus_timestamp': '1695495861.779232723',
                               'entity_id': None, 'max_fee': '1919999', 'memo_base64': 'MTAzODU3MjAz',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '4OPnThZnTijhi4R6cFNC0wUAZ89pJ3Z8D9HYGSoCV0AiFUdv9L99PJTtnqJd/NNs',
                               'transaction_id': '0.0.1067766-1695495857-825456279',
                               'transfers': [{'account': '0.0.4', 'amount': 7867, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 167925, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 18658, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 51156328842, 'is_approval': False},
                                             {'account': '0.0.1067766', 'amount': -51156523292, 'is_approval': False}],
                               'valid_duration_seconds': '180', 'valid_start_timestamp': '1695495857.825456279'},
                              {'bytes': None, 'charged_tx_fee': 195321, 'consensus_timestamp': '1695492903.089044003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.19', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'CMdBL2i1yjiwtJ34Nqx7k5k7YJ9e1lEJRfPfChIjXdoEIX71Sn4ehcDWkuyl4W71',
                               'transaction_id': '0.0.38674-1695492892-216261579',
                               'transfers': [{'account': '0.0.19', 'amount': 7911, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 168669, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 18741, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -99999999993350, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 99999999798029,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695492892.216261579'},
                              {'bytes': None, 'charged_tx_fee': 195766, 'consensus_timestamp': '1695492532.943507424',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAwMTc0ODc1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'PIN4vqK20bokkOn/3xTPk2/ctpsh0ui4CmOot93K4mF+QY9c3cpAwXkk8xvBDW4J',
                               'transaction_id': '0.0.2897-1695492521-696986110',
                               'transfers': [{'account': '0.0.4', 'amount': 7933, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 169050, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 18783, 'is_approval': False},
                                             {'account': '0.0.2897', 'amount': -100000000195766, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 100000000000000, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695492521.696986110'},
                              {'bytes': None, 'charged_tx_fee': 201971, 'consensus_timestamp': '1695303902.317488003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.13', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'EHzH4zkWxMdr8LMFAWXcsJQ8eqVTavL6eyq3BTGJkXSo2/uUH3LGlim3FkfiRid8',
                               'transaction_id': '0.0.38674-1695303890-371045795',
                               'transfers': [{'account': '0.0.13', 'amount': 8181, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174411, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19379, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -40700000001867, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 40699999799896,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695303890.371045795'},
                              {'bytes': None, 'charged_tx_fee': 202429, 'consensus_timestamp': '1695303858.696893003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'pyESRzbd2/WSRRtqyUX9MrPtdFoaGvGkVxU2hjRHk+NpYA57efpDbNeUX4Imc+Ya',
                               'transaction_id': '0.0.1392984-1695303826-718390462',
                               'transfers': [{'account': '0.0.3', 'amount': 8203, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174804, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19422, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 40500000000000, 'is_approval': False},
                                             {'account': '0.0.1392984', 'amount': -40500000202429,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695303826.718390462'},
                              {'bytes': None, 'charged_tx_fee': 202429, 'consensus_timestamp': '1695302033.114265003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '2UiJf9Lh4DVdHporDoJj/2VSGeskn/oNgtUyRDe5F0Mu/3RtYH35NaB6FuS9AIT+',
                               'transaction_id': '0.0.1392984-1695301978-960739979',
                               'transfers': [{'account': '0.0.3', 'amount': 8203, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174804, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19422, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 200000000000, 'is_approval': False},
                                             {'account': '0.0.1392984', 'amount': -200000202429, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695301978.960739979'},
                              {'bytes': None, 'charged_tx_fee': 200104, 'consensus_timestamp': '1695239102.797693003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.9', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'fKMQTXYK9KeBKEyl/P8tb18DMh2JhAc96fAdTUj1HyE+VA4ThLBmDKkWY5gjzrAP',
                               'transaction_id': '0.0.38674-1695239089-022492675',
                               'transfers': [{'account': '0.0.9', 'amount': 8105, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 172800, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19199, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -50928330756547, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 50928330556443,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695239089.022492675'},
                              {'bytes': None, 'charged_tx_fee': 200558, 'consensus_timestamp': '1695238450.581395003',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAwMTc0ODc1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'dChLBnV5usTN+KSwKh9kVGzQtHT0+vUniTuoB9IQI1N/kxT0HupfzRdyurtCLNdG',
                               'transaction_id': '0.0.2897-1695238439-532604065',
                               'transfers': [{'account': '0.0.4', 'amount': 8127, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 173188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19243, 'is_approval': False},
                                             {'account': '0.0.2897', 'amount': -50000000200558, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 50000000000000, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695238439.532604065'},
                              {'bytes': None, 'charged_tx_fee': 200558, 'consensus_timestamp': '1695236492.848499053',
                               'entity_id': None, 'max_fee': '400000', 'memo_base64': 'MTA0NTUxNTA3',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.6', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'wzhU9hU8f+TJfFfjSUGU7PG084lPqHhH98+wKi/iMyObFfDYBR8gNwr0KrxJNXGU',
                               'transaction_id': '0.0.1250276-1695236488-620000000',
                               'transfers': [{'account': '0.0.6', 'amount': 8127, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 173188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19243, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 197929573413, 'is_approval': False},
                                             {'account': '0.0.1250276', 'amount': -197929773971, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695236488.620000000'},
                              {'bytes': None, 'charged_tx_fee': 199264, 'consensus_timestamp': '1695162154.697065333',
                               'entity_id': None, 'max_fee': '400000', 'memo_base64': 'MTA0NTUxNTA3',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '5saBc8vBB+i0aMtNUt87I/n6xfU+nIsQnVe0uZ+7HpKOcNiMsEt96CFZN2mfNOC2',
                               'transaction_id': '0.0.1250276-1695162151-007000000',
                               'transfers': [{'account': '0.0.3', 'amount': 8074, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 172071, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19119, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 196853246494, 'is_approval': False},
                                             {'account': '0.0.1250276', 'amount': -196853445758, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695162151.007000000'}],
             'links': {
                 'next': '/api/v1/transactions?account.id=0.0.38674&limit=25&transactiontype=cryptotransfer&result=success&timestamp=lt:1695162154.697065333'}}
        ]
        mirror_node_api.request = Mock(side_effect=mirror_node_get_address_txs_mock_response)
        HederaExplorerInterface.address_txs_apis[0] = mirror_node_api
        mirror_node_address_txs = list()
        for address in self.address_txs:
            mirror_node_address_txs.append(BlockchainExplorer.get_wallet_transactions(address, Currencies.hbar, 'HBAR'))
        graphql_api = GraphqlHederaApi
        graphql_address_txs_mock_response = [
            {'transactions': [{'bytes': None, 'charged_tx_fee': 202379, 'consensus_timestamp': '1696100403.623366012',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.4', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'CHCjU2gg8KmzYWhEfgM6rrbkWLbhbGfCtbUD/zl7dQ4jKCy6qnaIa+/Cy0Mi2u09',
                               'transaction_id': '0.0.38674-1696100389-795053433',
                               'transfers': [{'account': '0.0.4', 'amount': 8197, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174764, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19418, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -33999999999760, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 33999999797381,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1696100389.795053433'},
                              {'bytes': None, 'charged_tx_fee': 202830, 'consensus_timestamp': '1696099768.935000003',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAwNzg4MzA4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'TMrUJl+JEp4xX1ItyzoF3GQpO7s0fGKbYFIESDkJ28ibxiFKbgQfCYd2q2N4O3zd',
                               'transaction_id': '0.0.161517-1696099726-988600225',
                               'transfers': [{'account': '0.0.4', 'amount': 8219, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175150, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19461, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 34000000000000, 'is_approval': False},
                                             {'account': '0.0.161517', 'amount': -34000000202830,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1696099726.988600225'},
                              {'bytes': None, 'charged_tx_fee': 202619, 'consensus_timestamp': '1695988803.316344003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.19', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'Ba2IkHAIkbDkUivjRafuQjZ2YWgozNnXWK4pBjV6Xy67OKA22lZ3Te3DspIcPYtj',
                               'transaction_id': '0.0.38674-1695988792-379185529',
                               'transfers': [{'account': '0.0.19', 'amount': 8207, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174971, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19441, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -1879968372992, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 1879968170373, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695988792.379185529'},
                              {'bytes': None, 'charged_tx_fee': 202908, 'consensus_timestamp': '1695988479.959919003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTAxMDIzOTUwCg==',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.12', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'TIlEZnAsHOMhPIri0WbDaDrZhL3bpOHqTLqW2HPkvLjpZXyjn9wUuwZKqYf9ZwTE',
                               'transaction_id': '0.0.947373-1695988469-492711143',
                               'transfers': [{'account': '0.0.12', 'amount': 8222, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175218, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19468, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 1316600000000, 'is_approval': False},
                                             {'account': '0.0.947373', 'amount': -1316600202908, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695988469.492711143'},
                              {'bytes': None, 'charged_tx_fee': 202857, 'consensus_timestamp': '1695988245.407690602',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTAxMDIzOTUw',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.27', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'VEire6xBonGrz8l70Br5afad4hf1tryLCUotqNYs7QES3yyl631+0ZAfpQ4g/EtV',
                               'transaction_id': '0.0.947373-1695988233-577706803',
                               'transfers': [{'account': '0.0.27', 'amount': 8220, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175174, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19463, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 10000000000, 'is_approval': False},
                                             {'account': '0.0.947373', 'amount': -10000202857, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695988233.577706803'},
                              {'bytes': None, 'charged_tx_fee': 202955, 'consensus_timestamp': '1695958924.241375003',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAyMzk4NzMw',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.16', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'BzkNp4Ro2lbW1iy/Wi0LRIZVjtUiK5RBjafvawjqfyozAX4f5hrvgL7nuXcevU+P',
                               'transaction_id': '0.0.1686716-1695958917-132282711',
                               'transfers': [{'account': '0.0.16', 'amount': 8224, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175258, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19473, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 351739860000, 'is_approval': False},
                                             {'account': '0.0.1686716', 'amount': -351740062955, 'is_approval': False}],
                               'valid_duration_seconds': '180', 'valid_start_timestamp': '1695958917.132282711'},
                              {'bytes': None, 'charged_tx_fee': 202955, 'consensus_timestamp': '1695956852.048122783',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0MzgxMTI1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.7', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'ECsO/ka2jaEmAvcKm6QzbmVcWKGYu1e3DldmU2d7xzYSAu4Kr084619Q21/r11zs',
                               'transaction_id': '0.0.845966-1695956842-737665842',
                               'transfers': [{'account': '0.0.7', 'amount': 8224, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175258, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19473, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 201628513175, 'is_approval': False},
                                             {'account': '0.0.845966', 'amount': -201628716130, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695956842.737665842'},
                              {'bytes': None, 'charged_tx_fee': 202802, 'consensus_timestamp': '1695924003.110434003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.13', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'dQO1BhX/fKPSu4QkvMUqWszz+4kBV6JTndNN/AIfbuhMRr6mPcF5zLafUf4eyZK1',
                               'transaction_id': '0.0.38674-1695923990-206523488',
                               'transfers': [{'account': '0.0.13', 'amount': 8214, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175130, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19458, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -5099999999236, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 5099999796434, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695923990.206523488'},
                              {'bytes': None, 'charged_tx_fee': 202874, 'consensus_timestamp': '1695923755.903899003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0MDgxMjU1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.22', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'tuAw03Cznwqbb2jrOS+mmXi1+V1Yf5YDOEDVXprOOaO5Ln5PLGzb12i1jDUkMYln',
                               'transaction_id': '0.0.1050547-1695923743-443744917',
                               'transfers': [{'account': '0.0.22', 'amount': 8221, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19465, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 5000000000000, 'is_approval': False},
                                             {'account': '0.0.1050547', 'amount': -5000000202874,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695923743.443744917'},
                              {'bytes': None, 'charged_tx_fee': 202874, 'consensus_timestamp': '1695923615.247364003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0MDgxMjU1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.21', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'NbC28uP3m1qhyOd3QoUbfhk9YndMz7wy/h3sRiWQxhqmYkqBH6HEjDxdPmHhi0dL',
                               'transaction_id': '0.0.1050547-1695923603-689181890',
                               'transfers': [{'account': '0.0.21', 'amount': 8221, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19465, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 100000000000, 'is_approval': False},
                                             {'account': '0.0.1050547', 'amount': -100000202874, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695923603.689181890'},
                              {'bytes': None, 'charged_tx_fee': 203566, 'consensus_timestamp': '1695913202.852538003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.11', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'R/pEDLW8yOF0nbl6Y5MtBORzWtZrrOJTsKcw2u/FJ3S15r1SxMVRiNHJ/cyMnXzk',
                               'transaction_id': '0.0.38674-1695913191-420570521',
                               'transfers': [{'account': '0.0.11', 'amount': 8245, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 175789, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19532, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -108134104828388, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 108134104624822,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695913191.420570521'},
                              {'bytes': None, 'charged_tx_fee': 204616, 'consensus_timestamp': '1695912368.599666083',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.8', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '4MEap6PXF0TervxaAjVGMZ1DGBT2cm5Fr4mYEae3Yis4WFKQBvybBCB+Mwl3Lu4H',
                               'transaction_id': '0.0.1454258-1695912357-027099927',
                               'transfers': [{'account': '0.0.8', 'amount': 8291, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176693, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19632, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 108134104828974, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': -108134105033590,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695912357.027099927'},
                              {'bytes': None, 'charged_tx_fee': 204152, 'consensus_timestamp': '1695912302.975616164',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.3', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'mYKrsBV3RiW227Efg1Pyn2m9jtajqFK931Gc5BNnxgC9bwkZNKczX2Hko8SD7Z6m',
                               'transaction_id': '0.0.38674-1695912292-276756881',
                               'transfers': [{'account': '0.0.3', 'amount': 8269, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176295, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19588, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -2361374866881, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 2361374662729, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695912292.276756881'},
                              {'bytes': None, 'charged_tx_fee': 204616, 'consensus_timestamp': '1695911638.775140338',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.8', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'g1rd7iDgY/aHnc4OcFj2IdHs95ETzq9N86eYVCSgkfLT/g0JRIeJUfAdn89efdpJ',
                               'transaction_id': '0.0.1454258-1695911626-396261009',
                               'transfers': [{'account': '0.0.8', 'amount': 8291, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176693, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19632, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 1810205100000, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': -1810205304616,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695911626.396261009'},
                              {'bytes': None, 'charged_tx_fee': 204533, 'consensus_timestamp': '1695767920.360873003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTAyODQzMDA4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.15', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'aJ1gaMrOaCvzr+FmyxoQK36wIxBDXvZxahA/4EkOENG2R8J2fOKfjG97ERb9Vect',
                               'transaction_id': '0.0.1917742-1695767919-217445219',
                               'transfers': [{'account': '0.0.15', 'amount': 8288, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 176621, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19624, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 500013429208, 'is_approval': False},
                                             {'account': '0.0.1917742', 'amount': -500013633741, 'is_approval': False}],
                               'valid_duration_seconds': '180', 'valid_start_timestamp': '1695767919.217445219'},
                              {'bytes': None, 'charged_tx_fee': 194450, 'consensus_timestamp': '1695495861.779232723',
                               'entity_id': None, 'max_fee': '1919999', 'memo_base64': 'MTAzODU3MjAz',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '4OPnThZnTijhi4R6cFNC0wUAZ89pJ3Z8D9HYGSoCV0AiFUdv9L99PJTtnqJd/NNs',
                               'transaction_id': '0.0.1067766-1695495857-825456279',
                               'transfers': [{'account': '0.0.4', 'amount': 7867, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 167925, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 18658, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 51156328842, 'is_approval': False},
                                             {'account': '0.0.1067766', 'amount': -51156523292, 'is_approval': False}],
                               'valid_duration_seconds': '180', 'valid_start_timestamp': '1695495857.825456279'},
                              {'bytes': None, 'charged_tx_fee': 195321, 'consensus_timestamp': '1695492903.089044003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.19', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'CMdBL2i1yjiwtJ34Nqx7k5k7YJ9e1lEJRfPfChIjXdoEIX71Sn4ehcDWkuyl4W71',
                               'transaction_id': '0.0.38674-1695492892-216261579',
                               'transfers': [{'account': '0.0.19', 'amount': 7911, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 168669, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 18741, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -99999999993350, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 99999999798029,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695492892.216261579'},
                              {'bytes': None, 'charged_tx_fee': 195766, 'consensus_timestamp': '1695492532.943507424',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAwMTc0ODc1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'PIN4vqK20bokkOn/3xTPk2/ctpsh0ui4CmOot93K4mF+QY9c3cpAwXkk8xvBDW4J',
                               'transaction_id': '0.0.2897-1695492521-696986110',
                               'transfers': [{'account': '0.0.4', 'amount': 7933, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 169050, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 18783, 'is_approval': False},
                                             {'account': '0.0.2897', 'amount': -100000000195766, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 100000000000000, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695492521.696986110'},
                              {'bytes': None, 'charged_tx_fee': 201971, 'consensus_timestamp': '1695303902.317488003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.13', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'EHzH4zkWxMdr8LMFAWXcsJQ8eqVTavL6eyq3BTGJkXSo2/uUH3LGlim3FkfiRid8',
                               'transaction_id': '0.0.38674-1695303890-371045795',
                               'transfers': [{'account': '0.0.13', 'amount': 8181, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174411, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19379, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -40700000001867, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 40699999799896,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695303890.371045795'},
                              {'bytes': None, 'charged_tx_fee': 202429, 'consensus_timestamp': '1695303858.696893003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'pyESRzbd2/WSRRtqyUX9MrPtdFoaGvGkVxU2hjRHk+NpYA57efpDbNeUX4Imc+Ya',
                               'transaction_id': '0.0.1392984-1695303826-718390462',
                               'transfers': [{'account': '0.0.3', 'amount': 8203, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174804, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19422, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 40500000000000, 'is_approval': False},
                                             {'account': '0.0.1392984', 'amount': -40500000202429,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695303826.718390462'},
                              {'bytes': None, 'charged_tx_fee': 202429, 'consensus_timestamp': '1695302033.114265003',
                               'entity_id': None, 'max_fee': '100000000', 'memo_base64': 'MTA0NDAzMjE4',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '2UiJf9Lh4DVdHporDoJj/2VSGeskn/oNgtUyRDe5F0Mu/3RtYH35NaB6FuS9AIT+',
                               'transaction_id': '0.0.1392984-1695301978-960739979',
                               'transfers': [{'account': '0.0.3', 'amount': 8203, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 174804, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19422, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 200000000000, 'is_approval': False},
                                             {'account': '0.0.1392984', 'amount': -200000202429, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695301978.960739979'},
                              {'bytes': None, 'charged_tx_fee': 200104, 'consensus_timestamp': '1695239102.797693003',
                               'entity_id': None, 'max_fee': '500000', 'memo_base64': '', 'name': 'CRYPTOTRANSFER',
                               'nft_transfers': [], 'node': '0.0.9', 'nonce': 0, 'parent_consensus_timestamp': None,
                               'result': 'SUCCESS', 'scheduled': False, 'staking_reward_transfers': [],
                               'token_transfers': [],
                               'transaction_hash': 'fKMQTXYK9KeBKEyl/P8tb18DMh2JhAc96fAdTUj1HyE+VA4ThLBmDKkWY5gjzrAP',
                               'transaction_id': '0.0.38674-1695239089-022492675',
                               'transfers': [{'account': '0.0.9', 'amount': 8105, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 172800, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19199, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': -50928330756547, 'is_approval': False},
                                             {'account': '0.0.1454258', 'amount': 50928330556443,
                                              'is_approval': False}], 'valid_duration_seconds': '120',
                               'valid_start_timestamp': '1695239089.022492675'},
                              {'bytes': None, 'charged_tx_fee': 200558, 'consensus_timestamp': '1695238450.581395003',
                               'entity_id': None, 'max_fee': '200000000', 'memo_base64': 'MTAwMTc0ODc1',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.4', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'dChLBnV5usTN+KSwKh9kVGzQtHT0+vUniTuoB9IQI1N/kxT0HupfzRdyurtCLNdG',
                               'transaction_id': '0.0.2897-1695238439-532604065',
                               'transfers': [{'account': '0.0.4', 'amount': 8127, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 173188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19243, 'is_approval': False},
                                             {'account': '0.0.2897', 'amount': -50000000200558, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 50000000000000, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695238439.532604065'},
                              {'bytes': None, 'charged_tx_fee': 200558, 'consensus_timestamp': '1695236492.848499053',
                               'entity_id': None, 'max_fee': '400000', 'memo_base64': 'MTA0NTUxNTA3',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.6', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': 'wzhU9hU8f+TJfFfjSUGU7PG084lPqHhH98+wKi/iMyObFfDYBR8gNwr0KrxJNXGU',
                               'transaction_id': '0.0.1250276-1695236488-620000000',
                               'transfers': [{'account': '0.0.6', 'amount': 8127, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 173188, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19243, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 197929573413, 'is_approval': False},
                                             {'account': '0.0.1250276', 'amount': -197929773971, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695236488.620000000'},
                              {'bytes': None, 'charged_tx_fee': 199264, 'consensus_timestamp': '1695162154.697065333',
                               'entity_id': None, 'max_fee': '400000', 'memo_base64': 'MTA0NTUxNTA3',
                               'name': 'CRYPTOTRANSFER', 'nft_transfers': [], 'node': '0.0.3', 'nonce': 0,
                               'parent_consensus_timestamp': None, 'result': 'SUCCESS', 'scheduled': False,
                               'staking_reward_transfers': [], 'token_transfers': [],
                               'transaction_hash': '5saBc8vBB+i0aMtNUt87I/n6xfU+nIsQnVe0uZ+7HpKOcNiMsEt96CFZN2mfNOC2',
                               'transaction_id': '0.0.1250276-1695162151-007000000',
                               'transfers': [{'account': '0.0.3', 'amount': 8074, 'is_approval': False},
                                             {'account': '0.0.98', 'amount': 172071, 'is_approval': False},
                                             {'account': '0.0.800', 'amount': 19119, 'is_approval': False},
                                             {'account': '0.0.38674', 'amount': 196853246494, 'is_approval': False},
                                             {'account': '0.0.1250276', 'amount': -196853445758, 'is_approval': False}],
                               'valid_duration_seconds': '120', 'valid_start_timestamp': '1695162151.007000000'}],
             'links': {
                 'next': '/api/v1/transactions?account.id=0.0.38674&limit=25&transactiontype=cryptotransfer&result=success&timestamp=lt:1695162154.697065333'}}
        ]
        graphql_api.request = Mock(side_effect=graphql_address_txs_mock_response)
        HederaExplorerInterface.address_txs_apis[0] = graphql_api
        graphql_address_txs = list()
        for address in self.address_txs:
            graphql_address_txs.append(BlockchainExplorer.get_wallet_transactions(address, Currencies.hbar, 'HBAR'))
        assert len(graphql_address_txs) == len(mirror_node_address_txs)
        for i in range(len(graphql_address_txs)):
            for mirror_node_transfer, graphql_transfer in zip(mirror_node_address_txs[i].get(Currencies.hbar),
                                                              graphql_address_txs[i].get(Currencies.hbar)):
                assert mirror_node_transfer.hash == graphql_transfer.hash

